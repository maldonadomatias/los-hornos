{"ast":null,"code":"import _asyncToGenerator from\"/Users/matiasmaldonado/Desktop/React/React-myProjects/los-hornos/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/matiasmaldonado/Desktop/React/React-myProjects/los-hornos/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/matiasmaldonado/Desktop/React/React-myProjects/los-hornos/node_modules/@babel/runtime/regenerator/index.js\";import React,{useEffect,useState,useContext}from\"react\";import Swal from\"sweetalert2\";import classes from\"./Orders.module.css\";import CartContext from\"../../../store/cart-context\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Orders=function Orders(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),order=_useState2[0],setOrder=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),error=_useState6[0],setError=_useState6[1];var cartCtx=useContext(CartContext);var addClearHandler=function addClearHandler(){cartCtx.clearCart();};useEffect(function(){var fetchOrders=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,responseData,loadedOrders,key;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"https://menu-app-d307a-default-rtdb.firebaseio.com/orders.json\");case 2:response=_context.sent;if(response.ok){_context.next=5;break;}throw new Error(\"Something went wrong!\");case 5:_context.next=7;return response.json();case 7:responseData=_context.sent;loadedOrders=[];for(key in responseData){// console.log(responseData[key].orderedItems)\nloadedOrders.push({id:key,orderedItems:responseData[key].orderedItems,total:responseData[key].total,user:responseData[key].user});}setOrder(loadedOrders);setIsLoading(false);console.log(loadedOrders);case 13:case\"end\":return _context.stop();}}},_callee);}));return function fetchOrders(){return _ref.apply(this,arguments);};}();setInterval(function(){fetchOrders();},10000);fetchOrders().catch(function(error){setIsLoading(false);setError(error.message);});},[]);if(isLoading){return/*#__PURE__*/_jsx(\"section\",{className:classes.mealsLoading,children:/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"})});}if(error){return/*#__PURE__*/_jsx(\"section\",{className:classes.mealsLoading,children:/*#__PURE__*/_jsx(\"p\",{children:Swal.fire({icon:\"error\",title:\"Oops...\",text:error})})});}var mealsList=order.reverse().map(function(orders){return/*#__PURE__*/_jsx(\"li\",{className:classes.order,children:/*#__PURE__*/_jsxs(\"div\",{className:classes.card,children:[/*#__PURE__*/_jsx(\"h3\",{children:orders.user.name}),/*#__PURE__*/_jsx(\"div\",{children:orders.orderedItems.map(function(item){return/*#__PURE__*/_jsxs(\"div\",{className:classes.description,children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{children:item.name}),/*#__PURE__*/_jsx(\"p\",{children:item.amount*item.price})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"p\",{className:classes.amount,children:[\" x \",item.amount]})})]});})}),/*#__PURE__*/_jsxs(\"div\",{className:classes.price,children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Total: \",orders.total.toFixed(2)]}),/*#__PURE__*/_jsx(\"button\",{onClick:addClearHandler,children:\"Eliminar\"})]})]})});});return/*#__PURE__*/_jsx(\"section\",{className:classes.orderContainer,children:/*#__PURE__*/_jsx(\"div\",{children:mealsList})});};export default Orders;","map":{"version":3,"sources":["/Users/matiasmaldonado/Desktop/React/React-myProjects/los-hornos/src/components/admin/components/Orders.js"],"names":["React","useEffect","useState","useContext","Swal","classes","CartContext","Orders","props","order","setOrder","isLoading","setIsLoading","error","setError","cartCtx","addClearHandler","clearCart","fetchOrders","fetch","response","ok","Error","json","responseData","loadedOrders","key","push","id","orderedItems","total","user","console","log","setInterval","catch","message","mealsLoading","fire","icon","title","text","mealsList","reverse","map","orders","card","name","item","description","amount","price","toFixed","orderContainer"],"mappings":"qcAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,CAAqCC,UAArC,KAAuD,OAAvD,CACA,MAAOC,CAAAA,IAAP,KAAiB,aAAjB,CAEA,MAAOC,CAAAA,OAAP,KAAoB,qBAApB,CACA,MAAOC,CAAAA,WAAP,KAAwB,6BAAxB,C,wFACA,GAAMC,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,CAACC,KAAD,CAAW,CACxB,cAA0BN,QAAQ,CAAC,EAAD,CAAlC,wCAAOO,KAAP,eAAcC,QAAd,eACA,eAAkCR,QAAQ,CAAC,IAAD,CAA1C,yCAAOS,SAAP,eAAkBC,YAAlB,eACA,eAA0BV,QAAQ,CAAC,IAAD,CAAlC,yCAAOW,KAAP,eAAcC,QAAd,eAEA,GAAMC,CAAAA,OAAO,CAAGZ,UAAU,CAACG,WAAD,CAA1B,CAEA,GAAMU,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,EAAM,CAC5BD,OAAO,CAACE,SAAR,GACD,CAFD,CAIAhB,SAAS,CAAC,UAAM,CACd,GAAMiB,CAAAA,WAAW,0FAAG,oMACKC,CAAAA,KAAK,CAC1B,gEAD0B,CADV,QACZC,QADY,kBAKbA,QAAQ,CAACC,EALI,8BAMV,IAAIC,CAAAA,KAAJ,CAAU,uBAAV,CANU,8BASSF,CAAAA,QAAQ,CAACG,IAAT,EATT,QASZC,YATY,eAWZC,YAXY,CAWG,EAXH,CAclB,IAAWC,GAAX,GAAkBF,CAAAA,YAAlB,CAAgC,CAC9B;AACAC,YAAY,CAACE,IAAb,CAAkB,CAChBC,EAAE,CAAEF,GADY,CAEhBG,YAAY,CAAEL,YAAY,CAACE,GAAD,CAAZ,CAAkBG,YAFhB,CAGhBC,KAAK,CAAEN,YAAY,CAACE,GAAD,CAAZ,CAAkBI,KAHT,CAIhBC,IAAI,CAAEP,YAAY,CAACE,GAAD,CAAZ,CAAkBK,IAJR,CAAlB,EAMD,CACDrB,QAAQ,CAACe,YAAD,CAAR,CACAb,YAAY,CAAC,KAAD,CAAZ,CACAoB,OAAO,CAACC,GAAR,CAAYR,YAAZ,EAzBkB,uDAAH,kBAAXP,CAAAA,WAAW,0CAAjB,CA8BAgB,WAAW,CAAC,UAAM,CAChBhB,WAAW,GACZ,CAFU,CAER,KAFQ,CAAX,CAIAA,WAAW,GAAGiB,KAAd,CAAoB,SAACtB,KAAD,CAAW,CAC7BD,YAAY,CAAC,KAAD,CAAZ,CACAE,QAAQ,CAACD,KAAK,CAACuB,OAAP,CAAR,CACD,CAHD,EAID,CAvCQ,CAuCN,EAvCM,CAAT,CAyCA,GAAIzB,SAAJ,CAAe,CACb,mBACE,gBAAS,SAAS,CAAEN,OAAO,CAACgC,YAA5B,uBACE,iCADF,EADF,CAKD,CAED,GAAIxB,KAAJ,CAAW,CACT,mBACE,gBAAS,SAAS,CAAER,OAAO,CAACgC,YAA5B,uBACE,mBACGjC,IAAI,CAACkC,IAAL,CAAU,CACTC,IAAI,CAAE,OADG,CAETC,KAAK,CAAE,SAFE,CAGTC,IAAI,CAAE5B,KAHG,CAAV,CADH,EADF,EADF,CAWD,CAED,GAAM6B,CAAAA,SAAS,CAAGjC,KAAK,CAACkC,OAAN,GAAgBC,GAAhB,CAAoB,SAACC,MAAD,qBACpC,WAAI,SAAS,CAAExC,OAAO,CAACI,KAAvB,uBACE,aAAK,SAAS,CAAEJ,OAAO,CAACyC,IAAxB,wBACE,oBAAKD,MAAM,CAACd,IAAP,CAAYgB,IAAjB,EADF,cAEE,qBACGF,MAAM,CAAChB,YAAP,CAAoBe,GAApB,CAAwB,SAACI,IAAD,qBACvB,aAAK,SAAS,CAAE3C,OAAO,CAAC4C,WAAxB,wBACE,oCACE,mBAAID,IAAI,CAACD,IAAT,EADF,cAEE,mBAAIC,IAAI,CAACE,MAAL,CAAcF,IAAI,CAACG,KAAvB,EAFF,GADF,cAKE,kCACE,WAAG,SAAS,CAAE9C,OAAO,CAAC6C,MAAtB,iBAAkCF,IAAI,CAACE,MAAvC,GADF,EALF,GADuB,EAAxB,CADH,EAFF,cAeE,aAAK,SAAS,CAAE7C,OAAO,CAAC8C,KAAxB,wBACE,+BAAWN,MAAM,CAACf,KAAP,CAAasB,OAAb,CAAqB,CAArB,CAAX,GADF,cAEE,eAAQ,OAAO,CAAEpC,eAAjB,sBAFF,GAfF,GADF,EADoC,EAApB,CAAlB,CAyBA,mBACE,gBAAS,SAAS,CAAEX,OAAO,CAACgD,cAA5B,uBACE,qBAAMX,SAAN,EADF,EADF,CAKD,CAxGD,CA0GA,cAAenC,CAAAA,MAAf","sourcesContent":["import React, { useEffect, useState, useContext } from \"react\";\nimport Swal from \"sweetalert2\";\n\nimport classes from \"./Orders.module.css\";\nimport CartContext from \"../../../store/cart-context\";\nconst Orders = (props) => {\n  const [order, setOrder] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  const cartCtx = useContext(CartContext);\n\n  const addClearHandler = () => {\n    cartCtx.clearCart();\n  };\n\n  useEffect(() => {\n    const fetchOrders = async () => {\n      const response = await fetch(\n        \"https://menu-app-d307a-default-rtdb.firebaseio.com/orders.json\"\n      );\n\n      if (!response.ok) {\n        throw new Error(\"Something went wrong!\");\n      }\n\n      const responseData = await response.json();\n      \n      const loadedOrders = [];\n      \n\n      for (const key in responseData) {\n        // console.log(responseData[key].orderedItems)\n        loadedOrders.push({\n          id: key,\n          orderedItems: responseData[key].orderedItems,\n          total: responseData[key].total,\n          user: responseData[key].user,\n        });\n      }\n      setOrder(loadedOrders);\n      setIsLoading(false);\n      console.log(loadedOrders);\n\n\n    };\n    \n    setInterval(() => {\n      fetchOrders()\n    }, 10000);\n\n    fetchOrders().catch((error) => {\n      setIsLoading(false);\n      setError(error.message);\n    });\n  }, []);\n\n  if (isLoading) {\n    return (\n      <section className={classes.mealsLoading}>\n        <p>Loading...</p>\n      </section>\n    );\n  }\n\n  if (error) {\n    return (\n      <section className={classes.mealsLoading}>\n        <p>\n          {Swal.fire({\n            icon: \"error\",\n            title: \"Oops...\",\n            text: error,\n          })}\n        </p>\n      </section>\n    );\n  }\n\n  const mealsList = order.reverse().map((orders) => (\n    <li className={classes.order}>\n      <div className={classes.card}>\n        <h3>{orders.user.name}</h3>\n        <div>\n          {orders.orderedItems.map((item) => (\n            <div className={classes.description}>\n              <div>\n                <p>{item.name}</p>\n                <p>{item.amount * item.price}</p>\n              </div>\n              <div>\n                <p className={classes.amount}> x {item.amount}</p>\n              </div>\n            </div>\n          ))}\n        </div>\n        <div className={classes.price}>\n          <p>Total: {orders.total.toFixed(2)}</p>\n          <button onClick={addClearHandler}>Eliminar</button>\n        </div>\n      </div>\n    </li>\n  ));\n\n  return (\n    <section className={classes.orderContainer}>\n      <div>{mealsList}</div>\n    </section>\n  );\n};\n\nexport default Orders;\n"]},"metadata":{},"sourceType":"module"}